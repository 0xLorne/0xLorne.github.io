<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CC-1337 | Cybersecurity Week 2023 - Writeup</title>
  <link rel="icon" type="image/x-icon" href="/assets/images/glider.ico">
  
  <link rel="stylesheet" href="/assets/css/main.css" />
  <link rel="stylesheet" href="/assets/css/post.css" />
  <link rel="stylesheet" href="/assets/css/syntax.css" />
  
  <link rel="stylesheet" href="/assets/css/common.css" />
  <script src="/assets/js/categories.js"></script>
  
  <script defer src="/assets/js/lbox.js"></script>
  
</head>

  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  
  <body>
    <main class="blogfeed">
      
<header>
  <a class="site-title article-page" href="/">CC-1337</a>
</header>



      
      <section id="article">
        
        <!--  -->
        
        <!--  -->
        
        <div
          class="article-thumbnail"
          style="
            background-image: url('/assets/images/CTF/cibersecurityweek.jpg');
          "
        >
          <h1 class="article-title">Cybersecurity Week 2023 - Writeup</h1>
          <div class="article-bottom">
            <div class="authors">
              
            </ul>
            </div>
            <small class="article-date">06 Dec 2023</small>
            <div class="article-categories">
              
              <a href="#!" class="article-category">pumahat</a>
              
              <a href="#!" class="article-category">ctf</a>
              
              <a href="#!" class="article-category">ciberseguridad</a>
              
            </div>
          </div>
        </div>
        <div class="article-content"><h1 id="writeup-cybersecurity-week-2023---pumahat">Writeup Cybersecurity week 2023  ~ Pumahat</h1>

<h6 id="nota-este-artículo-podría-no-contener-todos-los-retos-del-ctf-debido-a-que-no-pude-documentarlos-y-de-algunos-no-tengo-capturas-de-pantalla-sin-embargo-espero-que-sea-de-utilidad-para-el-lector"><strong>Nota:</strong> <em>Este artículo podría no contener todos los retos del CTF, debido a que no pude documentarlos y de algunos no tengo capturas de pantalla, sin embargo, espero que sea de utilidad para el lector</em></h6>

<ul>
  <li><a href="#cultura-general">Cultura general</a></li>
  <li><a href="#análisis-de-red">Análisis de red</a></li>
  <li><a href="#criptografía">Criptografía</a></li>
  <li><a href="#network">Network</a></li>
  <li><a href="#pentesting-web">Pentesting web</a></li>
  <li><a href="#miscelaneo">Miscelaneo</a></li>
  <li><a href="#osint">OSINT</a></li>
</ul>

<hr />

<h2 id="cultura-general">Cultura general</h2>

<h4 id="whoami">whoami</h4>

<p><img src="/assets/images/CTF/general/whoami.jpg" alt="Who Am I" width="60%" /></p>

<p>¿Quién es? <strong>Respuesta: Kevin Mitnick</strong></p>

<p>En caso de no saber quién es, se puede buscar la imagen y se obtiene la respuesta.</p>

<h4 id="silbato-de-captain-crunch">Silbato de Captain Crunch</h4>

<p><img src="/assets/images/CTF/general/silbato.jpg" alt="Silbato" width="60%" /></p>

<p>Esta imagen hace referencia al hackeo de sistemas telefónicos con el sonido que hacía este silbato, inventado por <strong>John Draper</strong>, en caso de no saber también se puede buscar con las palabras clave: “captain crunch whistle hack” y se encuentra el contexto.</p>

<h4 id="iphone-break">Iphone break</h4>

<p><img src="/assets/images/CTF/general/iphone.png" alt="iphone" width="50%" /></p>

<p>La imagen anterior es sobre la historia del jailbreak del Iphone, realizada por <strong>George Hotz</strong> a los 17 años.</p>

<hr />

<h2 id="análisis-de-red">Análisis de red</h2>

<h4 id="autenticación-insegura">Autenticación insegura</h4>

<p>Este reto nos pedía encontrar una bandera en un archivo pcap, para ello se utilizó la herramienta <code class="language-plaintext highlighter-rouge">wireshark</code> para analizar el archivo, al analizarlo podemos ver que hay paquetes de tipo <code class="language-plaintext highlighter-rouge">http</code> con método <code class="language-plaintext highlighter-rouge">GET</code> así que revisando con cuidado la información de estos, se encontró la flag en texto plano.</p>

<p><img src="/assets/images/CTF/wp/network1.png" alt="wireshark" /></p>

<h4 id="recuperando-imágenes">Recuperando imágenes</h4>

<p>Para este reto teníamos una pista sobre un archivo imagen en el segmento de paquetes pcap, así que igualmente usando <code class="language-plaintext highlighter-rouge">wireshark</code>, observando los paquetes, notamos que hubo un ingreso por <code class="language-plaintext highlighter-rouge">ftp</code>` y obtención de un archivo imagen, así que, filtrando los objetos de tipo data-ftp, pudimos obtener la imagen, y sólo bastaba con descargarla y obtener la flag.</p>

<p><img src="/assets/images/CTF/wp/wireshark2.png" alt="wireshark" /></p>

<p>y simplemente era visualizar la imagen y obtener la flag.</p>

<p><img src="/assets/images/CTF/wp/2.png" alt="get image" /></p>

<hr />

<h2 id="criptografía">Criptografía</h2>

<p><img src="/assets/images/CTF/wp/crypto/challenge.png" alt="Crypto Challenge" /></p>

<p>Esta imagen del emperador romano Cesar, hace alusión al cifrado cesar, que mueve n posiciones el alfabeto, en este caso se mueve 20 posiciones, así que usando herramientas online como CyberChef se puede obtener la respuesta.</p>

<p><img src="/assets/images/CTF/wp/crypto/cesar.png" alt="Cyberchef" /></p>

<hr />

<h2 id="network">Network</h2>

<h4 id="crackeando-ssh">Crackeando ssh</h4>

<p>Este desafío nos pedía crackear una contraseña de <code class="language-plaintext highlighter-rouge">ssh</code> para obtener la contraseña, sin embargo nos pedía explícitamente no utilizar fuerza bruta, así que, la segunda opción que no involucra activamente a la máquina objetivo, eran herramientas online como <code class="language-plaintext highlighter-rouge">crackstation</code> que es un diccionario de contraseñas, así que se utilizó esta herramienta para obtener la contraseña.</p>

<p><img src="/assets/images/CTF/wp/ssh_network.png" alt="ssh" /></p>

<p>una vez crackeada, simplemente era cuestión de entrar a la máquina con la contraseña obtenida y obtener la flag.</p>

<hr />

<h2 id="pentesting-web">Pentesting web</h2>

<h4 id="ssrf-server-side-request-forgery">SSRF (Server Side Request Forgery)</h4>

<p><img src="/assets/images/CTF/wp/ssrf.png" alt="SSRF" /></p>

<p>La página que se nos da para atacar, tiene un enlace para la página llamada “flag.php” sin embargo al acceder nos dice que no tenemos permiso para leer, así que lo primero que se hizo después de ver el código fuente es ver el formato de URL, y notamos que tiene un <strong>Server Side Request Forgery</strong>, por el formato de la URL:</p>

<p><code class="language-plaintext highlighter-rouge">https://pumahat.unam.mx:23350/index.php?content=index.php</code></p>

<p>por lo que en lugar de visitar directamente flag.php, se intentó hacerlo mediante el parámetro content, al hacerlo tampoco mostraba nada, pero viendo nuevamente el código fuente podemos leer el contenido de la página, y ahí se encuentra la flag.</p>

<p><img src="/assets/images/CTF/wp/ssrf2.png" alt="SSRF" /></p>

<h4 id="webshell">Webshell</h4>

<p>No tengo suficientes capturas de pantalla sobre este reto, pero consistía en revisar la página robots.txt, que normalmente es un archivo que incluye direcciones que no se deben visitar, entre ellas alguna que contenga la flag.</p>

<p><img src="/assets/images/CTF/wp/robots.jpg" alt="robots" /></p>

<p>La dirección contenía una api que comunicaba con la máquina, pero no tenía los suficientes filtros para evitar inputs no deseados, lo que fácilmente lo convirtió en un <code class="language-plaintext highlighter-rouge">RCE</code> la máquina ejecutaba un comando específico, pero podía fácilmente tener un bypass haciendo una injección de comandos como:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;comando&gt;; cat /home/user/flag.txt
</code></pre></div></div>
<p>(Normalmente se haría una búsqueda del archivo, pero el comando anterior era el más cercano al final del comando que se ejecutaba para leer la flag)</p>

<hr />

<h2 id="miscelaneo">Miscelaneo</h2>

<h4 id="git">Git</h4>

<p>En un reto nos pedían encontrar la flag en un git, por lo que este es un problema clásico de commits inseguros, así que lo que se hizo fué verificar los logs del git, y se encontró la flag en un commit.</p>

<p><img src="/assets/images/CTF/wp/git/history.png" alt="git log" /></p>

<p>Al revisar el historal de commits, generalmente en los primeros, encontramos malas prácticas como subir contraseñas, o en este caso la flag.</p>

<p>Paso a paso:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>require: tener el git ya clonado
1. git log -&gt; Muestra el historial de versiones de un git
2. git checkout &lt;commit&gt; -&gt; Cambia el estado del git al commit que se le indique
3. realizar una revisión de los documentos del git, en este caso se encontró la flag en el archivo **index.html**
</code></pre></div></div>

<p>al haber realizado estos sencillos comandos, pudimos obtener el código fuente de la página y encontrar la flag.</p>

<p><img src="/assets/images/CTF/wp/git/flag.png" alt="flag" /></p>

<h4 id="fe0">¿fe0?</h4>

<p>este reto nos da una pista del reto, ya que hace alusión a la firma de los archivos de tipo imagen jpeg, sin embargo era una cadena muy larga sin aparente sentido, utilizando herramientas como <strong>cyberchef</strong> me di cuenta que era texto en formato <code class="language-plaintext highlighter-rouge">base64</code> así que una vez decodificado, notamos que es un archivo <code class="language-plaintext highlighter-rouge">jpeg</code> y abriendo el archivo con un visor de imágenes, en mi caso fué con <code class="language-plaintext highlighter-rouge">feh</code> se puede ver la flag.</p>

<p><img src="/assets/images/CTF/wp/Fe0.png" alt="fe0" width="60%" /></p>

<h4 id="red-flag">Red Flag</h4>

<p>Este problema también es trivial, nos dan una imagen con una bandera roja, aparentemente normal, pero podemos inferir que tiene información dentro (Esteganografía), así que se utilizó la herramienta <code class="language-plaintext highlighter-rouge">steghide</code> para extraer la información de la imagen, y se obtuvo la flag.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>steghide extract -sf redflag.jpg
</code></pre></div></div>

<p><img src="/assets/images/CTF/wp/stego.png" alt="stego" /></p>

<h4 id="crackzip">Crackzip</h4>

<p>Para esta prueba nos dan un archivo zip, que al descomprimirlo nos pide una contraseña, lo primero que vino a mi mente y es de las herramientas más populares, fue el buen <code class="language-plaintext highlighter-rouge">john</code> para crackear la contraseña del archivo, esto consiste en convertir el archivo zip a un formato que pueda ser leído por <code class="language-plaintext highlighter-rouge">john</code> usando <code class="language-plaintext highlighter-rouge">zip2john</code>, y posteriormente crackearlo.</p>

<p>para ello basta con ejecutar los siguientes comandos:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zip2john challenge.zip &gt; secret.hash
</code></pre></div></div>
<p>para escribir el hash en un archivo llamado secret.hash, y posteriormente crackearlo con john, usando algún diccionario de contraseñas, en este caso se utilizó el clásico diccionario <code class="language-plaintext highlighter-rouge">rockyou.txt</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>john --wordlist=/usr/share/wordlists/rockyou.txt secret.hash
</code></pre></div></div>
<p><img src="/assets/images/CTF/wp/crackzip.png" alt="crackzip" /></p>

<p>al obtener la contraseña sólo era cuestión de descomprimir el zip y obtener la flag.</p>

<hr />

<h1 id="osint">OSINT</h1>

<h4 id="metadata">Metadata</h4>

<p>Este reto es muy similar al anterior, nos dan una imagen, sin embargo no contiene nada dentro, pero al revisar los metadatos de la imagen, se encuentra la flag, para esto se utilizó la herramienta <code class="language-plaintext highlighter-rouge">exiftool</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>exiftool metadata.jpg
</code></pre></div></div>

<p><img src="/assets/images/CTF/wp/metadata.png" alt="meta" /></p>

<p>Finalmente quiero agradecer al equipo de PumaHat por la excelente organización del evento, así como a las personas que dedicaron tiempo a realizar los retos (incluyendo los de hacking físico) me gustó bastante, también gracias a todos los participantes que hicieron de esto un reto divertido. Espero que este writeup les sea útil, y si tienen alguna pregunta o encuentran alguna imprecisión, no duden en ponerse en contacto conmigo a través de mis redes sociales. ¡Gracias!1</p>

<p>-Lorne</p>
</div>
      </section>
      <footer>
  <p>&copy; 2024 | CC-1337</p>
</footer>

    </main>
    <section id="category-modal-bg"></section>
<section id="category-modal">
  <h1 id="category-modal-title"></h1>
  <section id="category-modal-content"></section>
</section>

    <meta property="og:image" content="assets/images/CTF/cibersecurityweek.jpg">
  </body>
  
</html>
